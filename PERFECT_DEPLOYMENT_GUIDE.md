# ðŸš€ PERFECT DEPLOYMENT WALKTHROUGH

## ðŸŽ¯ OVERVIEW
We're deploying LeadNest in this order:
1. **Backend to Render** (API server)
2. **Update Frontend** (connect to live API)
3. **Final Testing** (E2E validation)

---

## ðŸ“‹ STEP 1: CREATE GITHUB REPOSITORY

### 1.1 Go to GitHub
- Open: https://github.com
- Login with: `useleadnest@gmail.com`

### 1.2 Create New Repository
- Click the **"+" button** (top right)
- Click **"New repository"**
- Repository name: `leadnest-backend`
- Description: `LeadNest SaaS Backend - FastAPI, PostgreSQL, Stripe`
- **IMPORTANT**: Select **PUBLIC** (required for free Render)
- **IMPORTANT**: Do NOT check any boxes (README, .gitignore, license)
- Click **"Create repository"**

### 1.3 Copy Repository URL
You'll see: `https://github.com/useleadnest/leadnest-backend.git`
**Copy this URL** - we'll need it next.

---

## ðŸ“‹ STEP 2: PUSH CODE TO GITHUB

### 2.1 Open Terminal in Backend Directory
```powershell
cd "c:\Users\mccab\contractornest\backend"
```

### 2.2 Set Remote URL
```powershell
git remote set-url origin https://github.com/useleadnest/leadnest-backend.git
```

### 2.3 Push Code
```powershell
git push -u origin main
```

**Expected Result**: Code pushed successfully to GitHub

---

## ðŸ“‹ STEP 3: DEPLOY TO RENDER

### 3.1 Go to Render
- Open: https://render.com
- Click **"Get Started for Free"**
- Sign up with: `useleadnest@gmail.com`

### 3.2 Connect GitHub
- Click **"New +"** (top right)
- Click **"Web Service"**
- Click **"Connect account"** (GitHub section)
- Authorize Render to access your GitHub

### 3.3 Select Repository
- Find: `leadnest-backend`
- Click **"Connect"**

### 3.4 Configure Service
Render will auto-detect our `render.yaml` file:
- **Name**: leadnest-backend
- **Environment**: Python
- **Build Command**: `pip install -r requirements.txt`
- **Start Command**: `uvicorn main:app --host 0.0.0.0 --port $PORT`
- Click **"Create Web Service"**

---

## ðŸ“‹ STEP 4: ADD ENVIRONMENT VARIABLES

### 4.1 Get Your API Keys First

**Stripe Keys:**
1. Go to: https://dashboard.stripe.com/apikeys
2. Copy **Publishable key** (starts with `pk_`)
3. Copy **Secret key** (starts with `sk_`)

**OpenAI Key:**
1. Go to: https://platform.openai.com/api-keys
2. Click **"Create new secret key"**
3. Copy the key (starts with `sk-`)

### 4.2 Add Variables in Render
In your Render dashboard:
- Click **"Environment"** (left sidebar)
- Add these variables:

```
STRIPE_PUBLISHABLE_KEY = pk_test_your_key_here
STRIPE_SECRET_KEY = sk_test_your_key_here
OPENAI_API_KEY = sk-your_openai_key_here
```

**Note**: `DATABASE_URL` and `JWT_SECRET_KEY` are auto-generated by Render

### 4.3 Deploy
- Click **"Manual Deploy"** â†’ **"Deploy latest commit"**

---

## ðŸ“‹ STEP 5: TEST BACKEND DEPLOYMENT

### 5.1 Get Your Backend URL
Once deployed, you'll see: `https://leadnest-backend-xyz.onrender.com`

### 5.2 Test Health Endpoint
Open in browser: `https://leadnest-backend-xyz.onrender.com/health`

**Expected Response:**
```json
{
  "status": "healthy",
  "environment": "production",
  "timestamp": "2025-08-14T..."
}
```

---

## ðŸ“‹ STEP 6: UPDATE FRONTEND

### 6.1 Update Environment File
Edit: `c:\Users\mccab\contractornest\frontend\.env.production`

Replace with your actual Render URL:
```
REACT_APP_API_URL=https://leadnest-backend-xyz.onrender.com
```

### 6.2 Rebuild and Deploy Frontend
```powershell
cd "c:\Users\mccab\contractornest\frontend"
npm run build
npx vercel --prod
```

---

## ðŸ“‹ STEP 7: SETUP STRIPE WEBHOOKS

### 7.1 Create Webhook Endpoint
1. Go to: https://dashboard.stripe.com/webhooks
2. Click **"Add endpoint"**
3. Endpoint URL: `https://leadnest-backend-xyz.onrender.com/stripe-webhook`
4. Select events: `customer.subscription.created`, `customer.subscription.updated`, `customer.subscription.deleted`
5. Click **"Add endpoint"**

### 7.2 Add Webhook Secret
1. Copy the **Signing secret** (starts with `whsec_`)
2. Add to Render environment variables:
```
STRIPE_WEBHOOK_SECRET = whsec_REDACTED
```
3. Deploy again in Render

---

## ðŸ“‹ STEP 8: FINAL TESTING

### 8.1 Test Full Flow
1. Go to: https://useleadnest.com
2. Sign up for a new account
3. Try the lead generation features
4. Test payment flow
5. Check admin dashboard

### 8.2 Verify Endpoints
- Health: `https://leadnest-backend-xyz.onrender.com/health`
- API Docs: `https://leadnest-backend-xyz.onrender.com/docs`

---

## âœ… SUCCESS CHECKLIST

- [ ] GitHub repository created
- [ ] Code pushed to GitHub
- [ ] Render account created
- [ ] Backend deployed to Render
- [ ] Environment variables added
- [ ] Health endpoint working
- [ ] Frontend updated with live API
- [ ] Frontend redeployed
- [ ] Stripe webhooks configured
- [ ] Full E2E test passed

---

## ðŸ†˜ TROUBLESHOOTING

**Backend won't start?**
- Check Render logs for errors
- Verify all environment variables are set

**Database errors?**
- Render auto-creates PostgreSQL
- Check DATABASE_URL is set

**Stripe errors?**
- Verify API keys are correct
- Check webhook endpoint URL

**Frontend can't connect?**
- Verify REACT_APP_API_URL is correct
- Check CORS settings in backend

---

## ðŸ“ž READY TO START?

Everything is prepared! You just need to:
1. Create GitHub repo (5 minutes)
2. Push code (1 minute)
3. Setup Render (10 minutes)
4. Add API keys (5 minutes)
5. Test deployment (5 minutes)

**Let's go! ðŸš€**
